<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="安全管理交互页面 - 通过视频学习和知识测试提升安全意识">
    <meta name="keywords" content="安全管理,安全教育,安全培训,知识测试">
    <title>安全管理交互页面</title>

    <!-- PWA 配置 -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#2563eb">
    <link rel="apple-touch-icon" href="/assets/images/icons/icon-192x192.png">

    <!-- 预加载关键资源 -->
    <link rel="preload" href="/assets/css/main.css" as="style">
    <link rel="preload" href="/assets/js/router.js" as="script">

    <!-- 样式表 -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <link rel="stylesheet" href="/assets/css/animations.css">

    <!-- 图标字体 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- 页面加载指示器 -->
    <div id="loading-indicator" class="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>正在加载...</p>
        </div>
    </div>

    <!-- 主应用容器 -->
    <div id="app-container" class="app-container">
        <!-- 导航栏 -->
        <nav class="navbar" role="navigation" aria-label="主导航">
            <div class="nav-container">
                <div class="nav-brand">
                    <a href="/" class="brand-link">
                        <i class="fas fa-shield-alt"></i>
                        <span>安全管理</span>
                    </a>
                </div>

                <div class="nav-menu" id="nav-menu">
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="/" class="nav-link active" data-page="home">
                                <i class="fas fa-home"></i>
                                <span>首页</span>
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" data-dropdown="video">
                                <i class="fas fa-play-circle"></i>
                                <span>视频学习</span>
                                <i class="fas fa-chevron-down"></i>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="/video1" class="dropdown-link">遵守规章制度</a></li>
                                <li><a href="/video2" class="dropdown-link">违规操作警示</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" data-dropdown="quiz">
                                <i class="fas fa-question-circle"></i>
                                <span>知识测试</span>
                                <i class="fas fa-chevron-down"></i>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="/quiz1" class="dropdown-link">按章操作测试</a></li>
                                <li><a href="/quiz2" class="dropdown-link">违规操作测试</a></li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a href="/admin" class="nav-link" data-page="admin">
                                <i class="fas fa-cog"></i>
                                <span>管理</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-toggle" id="nav-toggle">
                    <span class="toggle-line"></span>
                    <span class="toggle-line"></span>
                    <span class="toggle-line"></span>
                </div>
            </div>
        </nav>

        <!-- 主内容区域 -->
        <main class="main-content" role="main">
            <!-- 页面标题 -->
            <header class="page-header">
                <div class="container">
                    <h1 class="page-title">安全管理交互页面</h1>
                    <p class="page-subtitle">通过互动学习提升安全意识，共建安全工作环境</p>
                </div>
            </header>

            <!-- 功能卡片区域 -->
            <section class="features-section">
                <div class="container">
                    <div class="features-grid">
                        <!-- 视频学习卡片 -->
                        <div class="feature-card video-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-play-circle"></i>
                                </div>
                                <h2 class="card-title">视频学习</h2>
                            </div>
                            <div class="card-content">
                                <p class="card-description">
                                    通过真实案例视频学习安全操作规范，了解正确与错误操作的区别
                                </p>
                                <div class="card-options">
                                    <a href="/video1" class="option-link">
                                        <i class="fas fa-check-circle"></i>
                                        <span>遵守规章制度</span>
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                    <a href="/video2" class="option-link">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <span>违规操作警示</span>
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- 知识测试卡片 -->
                        <div class="feature-card quiz-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                                <h2 class="card-title">知识测试</h2>
                            </div>
                            <div class="card-content">
                                <p class="card-description">
                                    测试你的安全意识水平，通过互动问答巩固安全知识
                                </p>
                                <div class="card-options">
                                    <a href="/quiz1" class="option-link">
                                        <i class="fas fa-clipboard-check"></i>
                                        <span>按章操作测试</span>
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                    <a href="/quiz2" class="option-link">
                                        <i class="fas fa-clipboard-list"></i>
                                        <span>违规操作测试</span>
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- 数据统计卡片 -->
                        <div class="feature-card stats-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                                <h2 class="card-title">学习统计</h2>
                            </div>
                            <div class="card-content">
                                <p class="card-description">
                                    查看你的学习进度和测试成绩，追踪安全知识掌握情况
                                </p>
                                <div class="stats-overview">
                                    <div class="stat-item">
                                        <span class="stat-value" id="video-count">0</span>
                                        <span class="stat-label">视频观看</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-value" id="quiz-count">0</span>
                                        <span class="stat-label">测试完成</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-value" id="score-avg">0%</span>
                                        <span class="stat-label">平均分数</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 管理功能卡片 -->
                        <div class="feature-card admin-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-cog"></i>
                                </div>
                                <h2 class="card-title">系统管理</h2>
                            </div>
                            <div class="card-content">
                                <p class="card-description">
                                    管理员功能：查看用户数据、导出统计报告、系统配置
                                </p>
                                <div class="admin-actions">
                                    <a href="/admin" class="admin-link">
                                        <i class="fas fa-user-shield"></i>
                                        <span>进入管理后台</span>
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 快速开始区域 -->
            <section class="quick-start-section">
                <div class="container">
                    <div class="quick-start-content">
                        <h2 class="section-title">快速开始</h2>
                        <p class="section-description">选择你想要的学习方式，立即开始安全知识学习之旅</p>
                        <div class="quick-actions">
                            <a href="/video1" class="quick-action primary">
                                <i class="fas fa-play"></i>
                                <span>观看安全视频</span>
                            </a>
                            <a href="/quiz1" class="quick-action secondary">
                                <i class="fas fa-brain"></i>
                                <span>开始知识测试</span>
                            </a>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- 页脚 -->
        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-info">
                        <p>&copy; 2024 安全管理交互页面. 保留所有权利.</p>
                        <p>致力于提升工作场所安全意识</p>
                    </div>
                    <div class="footer-links">
                        <a href="#" class="footer-link">使用帮助</a>
                        <a href="#" class="footer-link">隐私政策</a>
                        <a href="#" class="footer-link">联系我们</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- 通知系统 -->
    <div id="notification-container" class="notification-container"></div>

    <!-- 模态框容器 -->
    <div id="modal-container" class="modal-container"></div>

    <!-- JavaScript 文件 -->
    <script src="/assets/js/router.js"></script>
    <script src="/assets/js/utils.js"></script>
    <script src="/assets/js/components.js"></script>
    <script src="/assets/js/main.js"></script>

    <!-- 页面初始化脚本 -->
    <script>
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function () {
            // 初始化路由系统
            const router = SafetyRouter.initRouter();

            // 初始化页面组件
            initializeComponents();

            // 加载用户统计数据
            loadUserStats();

            // 隐藏加载指示器
            hideLoadingIndicator();

            console.log('安全管理交互页面初始化完成');
        });

        // 初始化页面组件
        function initializeComponents() {
            // 初始化导航菜单
            initNavigation();

            // 初始化下拉菜单
            initDropdowns();

            // 初始化卡片动画
            initCardAnimations();
        }

        // 初始化导航
        function initNavigation() {
            const navToggle = document.getElementById('nav-toggle');
            const navMenu = document.getElementById('nav-menu');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', function () {
                    navMenu.classList.toggle('active');
                    navToggle.classList.toggle('active');
                });
            }
        }

        // 初始化下拉菜单
        function initDropdowns() {
            const dropdownToggles = document.querySelectorAll('.dropdown-toggle');

            dropdownToggles.forEach(toggle => {
                toggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    const dropdown = this.parentElement;
                    dropdown.classList.toggle('active');
                });
            });

            // 点击外部关闭下拉菜单
            document.addEventListener('click', function (e) {
                if (!e.target.closest('.dropdown')) {
                    document.querySelectorAll('.dropdown.active').forEach(dropdown => {
                        dropdown.classList.remove('active');
                    });
                }
            });
        }

        // 初始化卡片动画
        function initCardAnimations() {
            const cards = document.querySelectorAll('.feature-card');

            // 使用 Intersection Observer 实现滚动动画
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-in');
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });

            cards.forEach(card => {
                observer.observe(card);
            });
        }

        // 加载用户统计数据
        async function loadUserStats() {
            try {
                // 从本地存储或API获取统计数据
                const stats = getUserStatsFromStorage();

                // 更新页面显示
                updateStatsDisplay(stats);
            } catch (error) {
                console.error('加载统计数据失败:', error);
            }
        }

        // 从本地存储获取统计数据
        function getUserStatsFromStorage() {
            const defaultStats = {
                videoCount: 0,
                quizCount: 0,
                averageScore: 0
            };

            try {
                const stored = localStorage.getItem('userStats');
                return stored ? JSON.parse(stored) : defaultStats;
            } catch (error) {
                return defaultStats;
            }
        }

        // 更新统计数据显示
        function updateStatsDisplay(stats) {
            const videoCountEl = document.getElementById('video-count');
            const quizCountEl = document.getElementById('quiz-count');
            const scoreAvgEl = document.getElementById('score-avg');

            if (videoCountEl) videoCountEl.textContent = stats.videoCount;
            if (quizCountEl) quizCountEl.textContent = stats.quizCount;
            if (scoreAvgEl) scoreAvgEl.textContent = stats.averageScore + '%';
        }

        // 隐藏加载指示器
        function hideLoadingIndicator() {
            const loadingIndicator = document.getElementById('loading-indicator');
            if (loadingIndicator) {
                loadingIndicator.style.opacity = '0';
                setTimeout(() => {
                    loadingIndicator.style.display = 'none';
                }, 300);
            }
        }
    </script>
</body>

</html>